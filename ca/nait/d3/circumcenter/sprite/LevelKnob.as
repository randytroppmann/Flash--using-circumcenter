package ca.nait.d3.circumcenter.sprite{	import flash.display.MovieClip;	import flash.events.Event;	import flash.events.MouseEvent;		public class LevelKnob extends MovieClip{		private var _isDragging:Boolean;		protected const radNum:Number = 180/Math.PI;		protected var startDegrees:Number;				public function LevelKnob(){			addEventListener(Event.ADDED_TO_STAGE, handleAddedToStage, false, 0, true);			addEventListener(Event.REMOVED_FROM_STAGE, handleRemovedFormStage, false, 0, true);		}				protected function handleAddedToStage(event:Event):void{			stage.addEventListener(MouseEvent.MOUSE_UP, handleMouseUp, false, 0, true);			addEventListener(MouseEvent.MOUSE_DOWN, handleMouseDown, false, 0, true);					}		protected function handleRemovedFormStage(event:Event):void{			stage.removeEventListener(MouseEvent.MOUSE_UP, handleMouseUp);			removeEventListener(MouseEvent.MOUSE_DOWN, handleMouseDown);					}										protected function setRotation():void{			var degrees:Number = Math.round(Math.atan(mouseY/mouseX) * radNum);			var deltaDegrees:Number = degrees - startDegrees;			if (deltaDegrees > -100 && deltaDegrees < 100) {				knob.rotation += deltaDegrees;				var kEvent:KnobEvent = new KnobEvent(KnobEvent.CHANGE);				kEvent.delta = deltaDegrees;				dispatchEvent(kEvent);			}			startDegrees = degrees;							}										protected function handleMouseMoveWhileDragging(event:MouseEvent):void{			setRotation();					}		protected function handleMouseDown(event:MouseEvent):void{			startDegrees = Math.round(Math.atan(mouseY/mouseX) * radNum);			isDragging = true;					}			protected function handleMouseUp(event:MouseEvent):void{			isDragging = false;						}														public function get isDragging():Boolean{			return _isDragging;		}				public function set isDragging(value:Boolean):void{			_isDragging = value;			if (stage){				if (isDragging) stage.addEventListener(MouseEvent.MOUSE_MOVE, handleMouseMoveWhileDragging, false, 0, true);				else stage.removeEventListener(MouseEvent.MOUSE_MOVE, handleMouseMoveWhileDragging);			}			else{				trace("stage is null");			}					}							}}